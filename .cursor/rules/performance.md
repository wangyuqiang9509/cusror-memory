# 性能优化

## 模型选择策略

**Haiku 4.5**（达到 Sonnet 90% 能力，成本降低 3 倍）：
- 高频调用的轻量级 Agent
- 结对编程与代码生成
- 多 Agent 系统中的 Worker 节点

**Sonnet 4.5**（最佳编码模型）：
- 主开发任务
- 多 Agent 工作流编排
- 复杂编码任务

**Opus 4.5**（最强推理能力）：
- 复杂架构决策
- 极限推理需求场景
- 研究与分析任务

## 上下文窗口管理

当上下文窗口使用超过 80% 时，应避免执行以下任务：
- 大规模重构
- 跨多文件的功能实现
- 复杂交互的调试

以下任务对上下文敏感度较低：
- 单文件编辑
- 独立工具函数开发
- 文档更新
- 简单 Bug 修复

## Ultrathink + Plan 模式

针对需要深度推理的复杂任务：
1. 使用 `ultrathink` 激活增强思考模式
2. 启用 **Plan Mode** 进行结构化规划
3. 通过多轮批判性审视「预热引擎」
4. 采用角色分离的子 Agent 进行多元分析

## 构建故障排查

构建失败时：
1. 调用 **build-error-resolver** Agent
2. 分析错误信息
3. 增量修复
4. 每次修复后验证
