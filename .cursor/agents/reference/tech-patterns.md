# 技术栈 Bug 模式知识库

> 此文档按需引用：在执行 `/init-project` 命令时自动读取

## 概述

本文档记录项目所使用技术栈的常见 Bug 模式、预防规则和最佳实践。

**初始状态**：此文件为通用模板，运行 `/customize-cursor` 命令后将根据项目实际技术栈自动填充相关内容。

---

## 技术栈 Bug 模式

<!-- PATTERNS_START -->
<!-- 此区域由 /customize-cursor 命令根据项目技术栈自动填充 -->

**当前状态**：尚未检测到项目技术栈

运行 `/customize-cursor` 命令以：
1. 自动扫描项目使用的技术栈
2. 生成针对性的 Bug 模式和预防规则
3. 添加技术栈特定的最佳实践

<!-- PATTERNS_END -->

---

## 通用 Bug 模式

以下是适用于所有项目的通用 Bug 模式：

### 代码质量类

| Bug 类型 | 描述 | 预防规则 |
|---------|------|---------|
| 硬编码配置 | 敏感信息或环境相关值硬编码在代码中 | 使用环境变量或配置文件 |
| 魔法数字/字符串 | 代码中使用未解释的字面量 | 定义常量并添加注释 |
| 重复代码 | 相同逻辑在多处重复 | 提取公共函数/组件 |
| 过深嵌套 | 条件或循环嵌套层级过深 | 早返回、提取函数 |

### 错误处理类

| Bug 类型 | 描述 | 预防规则 |
|---------|------|---------|
| 静默失败 | 错误被捕获但未处理或记录 | 至少记录日志 |
| 过于宽泛的捕获 | catch 所有异常导致隐藏真实问题 | 捕获特定异常类型 |
| 未处理的边界情况 | 空值、空数组、极端输入未处理 | 添加边界检查 |

### 安全类

| Bug 类型 | 描述 | 预防规则 |
|---------|------|---------|
| 密钥泄露 | 密钥或凭证提交到代码库 | .gitignore + 密钥管理工具 |
| 不安全的依赖 | 使用有已知漏洞的依赖 | 定期运行安全审计 |
| 缺少输入验证 | 用户输入未验证直接使用 | 在边界处验证所有输入 |

---

## 项目类型特定关注点

根据项目类型，应特别关注以下领域：

### Web 应用

| 关注领域 | 典型问题 |
|---------|---------|
| 认证/授权 | 会话管理、权限检查遗漏 |
| 跨站安全 | XSS、CSRF 防护 |
| 性能优化 | 懒加载、缓存策略、资源压缩 |
| 响应式设计 | 不同设备的兼容性 |

### CLI 工具

| 关注领域 | 典型问题 |
|---------|---------|
| 参数解析 | 参数验证、帮助信息 |
| 用户体验 | 错误提示友好性、进度显示 |
| 跨平台 | 路径分隔符、换行符 |
| 退出码 | 规范的退出码定义 |

### 库/SDK

| 关注领域 | 典型问题 |
|---------|---------|
| API 设计 | 向后兼容、版本管理 |
| 文档 | API 文档完整性、示例代码 |
| 类型定义 | 类型导出、泛型支持 |
| 依赖 | 最小化依赖、避免冲突 |

### 微服务

| 关注领域 | 典型问题 |
|---------|---------|
| 服务通信 | 超时设置、重试策略 |
| 容错 | 熔断、降级、限流 |
| 可观测性 | 日志、指标、追踪 |
| 数据一致性 | 分布式事务、最终一致性 |

---

## 如何扩展本文档

### 方式一：自动扩展（推荐）

运行 `/customize-cursor` 命令，系统将：
1. 扫描项目代码识别技术栈
2. 自动填充「技术栈 Bug 模式」区域
3. 保留已有的自定义规则

### 方式二：手动添加

使用以下模板在「技术栈 Bug 模式」区域添加内容：

```markdown
### [技术名称]

**常见 Bug 类型：**

| Bug 类型 | 描述 | 预防规则 |
|---------|------|---------|
| [类型] | [描述] | [规则] |

**推荐规则：**

- ✅ 应该：[正确做法]
- ❌ 避免：[错误做法]
```

### 方式三：从 Bug 中积累

开发过程中使用 `BUG: [问题描述]` 报告 Bug，系统会自动：
1. 分析 Bug 根因
2. 提炼可复用规则
3. 更新到「从 Bug 中学到的规则」区域

---

## 从 Bug 中学到的规则

<!-- BUG_RULES_START -->
<!-- 此区域由 BUG: 命令自动更新，请勿手动修改标记 -->

*尚未积累规则。在开发过程中使用 `BUG: [问题描述]` 来沉淀经验。*

<!-- BUG_RULES_END -->

---

*文档版本：2.0.0*
*模板类型：通用版*
*最后更新：项目初始化*
