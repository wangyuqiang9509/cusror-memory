{
  "version": 1,
  "hooks": {
    "sessionStart": [
      {
        "command": "node \".cursor/scripts/hooks/session-start.js\"",
        "timeout": 10
      }
    ],
    "sessionEnd": [
      {
        "command": "node \".cursor/scripts/hooks/session-end.js\"",
        "timeout": 10
      },
      {
        "command": "node \".cursor/scripts/hooks/evaluate-session.js\"",
        "timeout": 10
      }
    ],
    "preCompact": [
      {
        "command": "node \".cursor/scripts/hooks/pre-compact.js\"",
        "timeout": 10
      }
    ],
    "afterFileEdit": [
      {
        "command": "node \".cursor/scripts/hooks/suggest-compact.js\"",
        "timeout": 10
      },
      {
        "command": "node -e \"const{execSync}=require('child_process');const fs=require('fs');let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{const i=JSON.parse(d);const p=i.file_path;if(p&&fs.existsSync(p)&&/\\.(ts|tsx|js|jsx)$/.test(p)){try{execSync('npx prettier --write \"'+p+'\"',{stdio:['pipe','pipe','pipe']})}catch(e){}}})\"",
        "timeout": 30
      },
      {
        "command": "node -e \"const fs=require('fs');let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{const i=JSON.parse(d);const p=i.file_path;if(p&&fs.existsSync(p)&&/\\.(ts|tsx|js|jsx)$/.test(p)){const c=fs.readFileSync(p,'utf8');const lines=c.split('\\n');const matches=[];lines.forEach((l,idx)=>{if(/console\\.log/.test(l))matches.push((idx+1)+': '+l.trim())});if(matches.length){console.error('[Hook] 警告: 在 '+p+' 中发现 console.log');matches.slice(0,5).forEach(m=>console.error(m));console.error('[Hook] 提交前请移除 console.log')}}})\"",
        "timeout": 10
      }
    ],
    "stop": [
      {
        "command": "node -e \"const{execSync}=require('child_process');const fs=require('fs');let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{try{execSync('git rev-parse --git-dir',{stdio:'pipe'})}catch{process.exit(0)}try{const files=execSync('git diff --name-only HEAD',{encoding:'utf8',stdio:['pipe','pipe','pipe']}).split('\\n').filter(f=>/\\.(ts|tsx|js|jsx)$/.test(f)&&fs.existsSync(f));let hasConsole=false;for(const f of files){if(fs.readFileSync(f,'utf8').includes('console.log')){console.error('[Hook] 警告: 在 '+f+' 中发现 console.log');hasConsole=true}}if(hasConsole)console.error('[Hook] 提交前请移除 console.log 语句')}catch(e){}})\"",
        "timeout": 15,
        "loop_limit": 5
      }
    ]
  }
}
