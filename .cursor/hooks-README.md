## 详细说明文档

### 文件概述
这是一个 Claude 代码插件的钩子（Hooks）配置文件，定义了在不同生命周期事件中自动执行的脚本和命令。版本号为 1。

### 钩子类型说明

#### 1. `sessionStart` - 会话开始钩子
- **执行时机**：当 Claude 会话开始时
- **功能**：运行 `session-start.js` 脚本，用于会话初始化
- **超时时间**：10秒

#### 2. `sessionEnd` - 会话结束钩子
- **执行时机**：当 Claude 会话结束时
- **功能**：
  - 运行 `session-end.js` 脚本，用于清理工作
  - 运行 `evaluate-session.js` 脚本，用于评估本次会话
- **超时时间**：每个钩子 10秒

#### 3. `preCompact` - 压缩前钩子
- **执行时机**：在执行压缩操作之前
- **功能**：运行 `pre-compact.js` 脚本，用于压缩前的准备工作
- **超时时间**：10秒

#### 4. `beforeShellExecution` - 命令执行前钩子
包含三个子钩子：

**开发服务器阻止钩子**：
- **匹配命令**：`npm run dev`, `pnpm dev`, `yarn dev`, `bun run dev`
- **功能**：阻止直接运行开发服务器，要求必须在 tmux 中运行
- **原因**：便于访问开发服务器日志

**tmux 建议钩子**：
- **匹配命令**：包管理器命令、构建命令、测试命令等
- **功能**：如果不在 tmux 环境中运行，建议使用 tmux 以保持会话持久性

**Git 推送警告钩子**：
- **匹配命令**：`git push`
- **功能**：推送前发出警告，提醒检查更改

#### 5. `afterShellExecution` - 命令执行后钩子

**PR 创建后处理钩子**：
- **匹配命令**：`gh pr create`
- **功能**：解析输出中的 PR URL，显示创建成功的 PR 链接和审查命令

**构建完成通知钩子**：
- **匹配命令**：`npm run build`, `pnpm build`, `yarn build`
- **功能**：构建完成后显示通知，提示后台异步分析正在运行

#### 6. `afterFileEdit` - 文件编辑后钩子

**压缩建议钩子**：
- **功能**：运行 `suggest-compact.js` 脚本，建议何时进行代码压缩

**代码格式化钩子**：
- **适用文件**：TypeScript 和 JavaScript 文件 (`.ts`, `.tsx`, `.js`, `.jsx`)
- **功能**：使用 Prettier 自动格式化代码

**console.log 警告钩子**：
- **适用文件**：TypeScript 和 JavaScript 文件
- **功能**：检测并警告文件中存在的 `console.log` 语句，提醒在提交前移除

#### 7. `stop` - 停止钩子
- **执行时机**：插件停止时
- **功能**：
  - 检查 Git 暂存区中的 TypeScript/JavaScript 文件
  - 检测是否存在 `console.log` 语句
  - 如果发现，发出警告提醒在提交前移除
- **特殊配置**：
  - **超时时间**：15秒
  - **循环限制**：5次（防止无限循环）

### 配置参数说明

- **`command`**：要执行的命令字符串
- **`timeout`**：命令执行的超时时间（秒）
- **`matcher`**：匹配的命令模式（正则表达式）
- **`loop_limit`**：循环执行次数限制

### 环境变量
- **`${CLAUDE_PLUGIN_ROOT}`**：Claude 插件的根目录路径

### 注意事项
1. 所有钩子都是异步执行的，不会阻塞主要操作
2. 如果钩子执行失败，会记录到错误日志但不会中断用户操作
3. 某些钩子依赖外部工具（如 Prettier、Git CLI、GitHub CLI）
4. 钩子主要用于代码质量保证、开发环境管理和工作流程自动化