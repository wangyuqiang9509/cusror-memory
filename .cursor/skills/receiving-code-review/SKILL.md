---
name: receiving-code-review
description: 当收到代码审查反馈时使用，在实施建议之前，特别是当反馈似乎不清楚或技术上存疑时 - 需要技术严谨性和验证，而非表演性认同或盲目实施
---

# 代码审查接收

## 概述

代码审查需要技术评估，而非情绪表演。

**核心原则：** 实施前先验证。假设前先询问。技术正确性优先于社交舒适度。

## 响应模式

```
收到代码审查反馈时：

1. 阅读：完整阅读反馈，不要急于反应
2. 理解：用自己的话复述要求（或询问）
3. 验证：对照代码库实际情况检查
4. 评估：对于当前代码库是否技术合理？
5. 响应：技术性确认或有理有据的反驳
6. 实施：逐项实施，逐项测试
```

## 禁止的回应

**绝对不要：**
- "你说得太对了！"（明确违反 CLAUDE.md）
- "好观点！" / "很棒的反馈！"（表演性的）
- "让我现在就实施"（在验证之前）

**应该这样做：**
- 复述技术要求
- 询问澄清性问题
- 如果有误则用技术理由反驳
- 直接开始工作（行动 > 言语）

## 处理不清晰的反馈

```
如果任何条目不清楚：
  停止 - 暂时不要实施任何内容
  询问不清楚条目的澄清

原因：条目之间可能相关。部分理解 = 错误实施。
```

**示例：**
```
你的人类伙伴："修复 1-6"
你理解 1,2,3,6。对 4,5 不清楚。

❌ 错误：先实施 1,2,3,6，之后再问 4,5
✅ 正确："我理解条目 1,2,3,6。在继续之前需要澄清 4 和 5。"
```

## 按来源分类处理

### 来自你的人类伙伴
- **可信任** - 理解后即可实施
- **仍需询问** 如果范围不清楚
- **不要表演性认同**
- **直接行动** 或技术性确认

### 来自外部审查者
```
实施之前：
  1. 检查：对于当前代码库技术上是否正确？
  2. 检查：是否会破坏现有功能？
  3. 检查：当前实现的原因是什么？
  4. 检查：是否适用于所有平台/版本？
  5. 检查：审查者是否理解完整上下文？

如果建议似乎有误：
  用技术理由反驳

如果无法轻易验证：
  直说："没有 [X] 我无法验证这一点。是否应该 [调查/询问/继续]？"

如果与你的人类伙伴之前的决定冲突：
  先停下来与你的人类伙伴讨论
```

**你的人类伙伴的规则：** "外部反馈 - 保持怀疑，但仔细检查"

## YAGNI 检查"专业"功能

```
如果审查者建议"正确实现"：
  在代码库中 grep 实际使用情况

  如果未使用："这个端点没有被调用。删除它（YAGNI）？"
  如果在使用：那就正确实现
```

**你的人类伙伴的规则：** "你和审查者都向我汇报。如果我们不需要这个功能，就不要添加。"

## 实施顺序

```
对于多条目反馈：
  1. 首先澄清任何不清楚的内容
  2. 然后按此顺序实施：
     - 阻塞性问题（崩溃、安全）
     - 简单修复（拼写错误、导入）
     - 复杂修复（重构、逻辑）
  3. 逐个测试每个修复
  4. 验证没有回归
```

## 何时反驳

在以下情况反驳：
- 建议会破坏现有功能
- 审查者缺乏完整上下文
- 违反 YAGNI（未使用的功能）
- 对于当前技术栈技术上不正确
- 存在遗留/兼容性原因
- 与你的人类伙伴的架构决策冲突

**如何反驳：**
- 使用技术理由，而非防御性
- 询问具体问题
- 引用可工作的测试/代码
- 如果涉及架构则让你的人类伙伴参与

**如果不方便大声反驳的信号：** "Strange things are afoot at the Circle K"

## 确认正确的反馈

当反馈确实正确时：
```
✅ "已修复。[简要描述更改内容]"
✅ "好发现 - [具体问题]。在 [位置] 修复。"
✅ [直接修复并在代码中展示]

❌ "你说得太对了！"
❌ "好观点！"
❌ "感谢你发现这个！"
❌ "感谢 [任何内容]"
❌ 任何感谢表达
```

**为什么不感谢：** 行动说明一切。直接修复。代码本身就表明你听到了反馈。

**如果你发现自己要写"感谢"：** 删掉它。改为陈述修复内容。

## 优雅地纠正你的反驳

如果你反驳了但错了：
```
✅ "你是对的 - 我检查了 [X]，它确实 [Y]。现在实施。"
✅ "验证了这一点，你是正确的。我最初的理解有误，因为 [原因]。正在修复。"

❌ 长篇道歉
❌ 为什么你反驳的辩护
❌ 过度解释
```

客观陈述纠正内容并继续前进。

## 常见错误

| 错误 | 修正 |
|------|------|
| 表演性认同 | 陈述要求或直接行动 |
| 盲目实施 | 先对照代码库验证 |
| 批量处理不测试 | 逐个处理，逐个测试 |
| 假设审查者正确 | 检查是否会破坏功能 |
| 避免反驳 | 技术正确性 > 舒适度 |
| 部分实施 | 先澄清所有条目 |
| 无法验证仍继续 | 说明限制，请求指导 |

## 真实示例

**表演性认同（错误）：**
```
审查者："删除遗留代码"
❌ "你说得太对了！让我删除那个..."
```

**技术验证（正确）：**
```
审查者："删除遗留代码"
✅ "检查中... 构建目标是 10.15+，这个 API 需要 13+。需要遗留代码来向后兼容。当前实现有错误的 bundle ID - 是修复它还是放弃 pre-13 支持？"
```

**YAGNI（正确）：**
```
审查者："用数据库、日期过滤器、CSV 导出正确实现指标跟踪"
✅ "在代码库中 grep 了 - 没有任何地方调用这个端点。删除它（YAGNI）？还是有我遗漏的使用场景？"
```

**不清楚的条目（正确）：**
```
你的人类伙伴："修复条目 1-6"
你理解 1,2,3,6。对 4,5 不清楚。
✅ "理解 1,2,3,6。在实施之前需要澄清 4 和 5。"
```

## GitHub 线程回复

在 GitHub 上回复内联审查评论时，在评论线程中回复（`gh api repos/{owner}/{repo}/pulls/{pr}/comments/{id}/replies`），而不是作为顶级 PR 评论。

## 底线

**外部反馈 = 需要评估的建议，而非需要遵循的命令。**

验证。质疑。然后实施。

不要表演性认同。始终保持技术严谨。
